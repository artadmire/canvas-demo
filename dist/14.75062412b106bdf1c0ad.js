(window.webpackJsonp=window.webpackJsonp||[]).push([[14,39,40,41,42],{"0Pcb":function(t,e,i){"use strict";const s=function(){const t=window.navigator.userAgent;return window.location.href,function(t){const e={},i=t.indexOf("iPhone")>=0||t.indexOf("iPad")>=0||t.indexOf("iPod")>=0,s=t.indexOf("Android")>0;return e.ios=i,e.android=s,e.mobile=i||s,e.pc=!i&&!s,e}(t)}();e.a=s},"JS/M":function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return n});var s=i("ysz4");class n{constructor(){return this instanceof n?this:new n}isCandidateForCollide(t,e){return t.visible&&e.visible&&t!==e}didCollide(t,e){if("circle"===t.type&&"circle"===e.type){let i=t.x,n=t.y,r=t.radius,l=e.x,o=e.y,h=e.radius;return Object(s.a)(i,n,l,o)<=r+h}let i="circle"===t.type?t.getAxes(e):t.getAxes(),n="circle"===e.type?e.getAxes(t):e.getAxes(),r=[...i,...n];for(let i of r){let s=t.getProjection(i),n=e.getProjection(i);if(!s.overlaps(n))return!1}return!0}}},Qb4n:function(t,e,i){"use strict";var s=i("kZAv");e.a=class{constructor(){this.el=document.createElement("canvas")}initCanvasSize(t,e){this.el.width=t,this.el.height=e,this.width=t,this.height=e}getContext(t,e){return this.el.getContext(t,e)}render(t){this.container=t;let{width:e,height:i}=t.getBoundingClientRect();this.initCanvasSize(e||s.d,i||s.b),this.container.innerHTML="",this.container.appendChild(this.el)}}},Vz5x:function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return l}),i.d(e,"Polygon",function(){return o}),i.d(e,"Circle",function(){return h});var s=i("honw"),n=i("iSVj"),r=i("ysz4");class l{constructor({type:t,fillStyle:e,name:i="anonymous",visible:s=!1}={}){this.type=t,this.name=i,this.visible=s,this.fillStyle=e}}class o extends l{constructor(t){super(t),this.type="rect",this.edges=t.edges,this.radius=t.radius,this.x=t.x,this.y=t.y,this.createPoint()}createPoint(){let{x:t,y:e,edges:i,radius:s}=this,n=2*Math.PI/i,r=[];for(let l=0;l<i;l++){let i=n*(l+1);r.push({x:Math.cos(i)*s+t,y:Math.sin(i)*s+e})}this.points=r}render(t){let{edges:e,points:i,fillStyle:s}=this;t.save(),t.fillStyle=s;let n=i[0];t.beginPath(),t.moveTo(n.x,n.y);for(let s=1;s<e;s++)t.lineTo(i[s].x,i[s].y);t.closePath(),t.fill(),t.restore()}getAxes(){let t=this.points,e=[];for(let i=0,n=t.length-1;i<n;i++){let n=new s.default(t[i].x,t[i].y),r=new s.default(t[i+1].x,t[i+1].y);e.push(n.subtract(r).perpendicular().normalize())}let i=t[0],n=t[t.length-1],r=new s.default(n.x,n.y),l=new s.default(i.x,i.y);return e.push(r.subtract(l).perpendicular().normalize()),e}getProjection(t){let e=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(let n of this.points){let r=new s.default(n.x,n.y).dotProduct(t);e=Math.min(e,r),i=Math.max(i,r)}return new n.default(e,i)}isPointInPath(t,e,i){let{edges:s,points:n}=this,r=n[0];t.beginPath(),t.moveTo(r.x,r.y);for(let e=1;e<s;e++)t.lineTo(n[e].x,n[e].y);return t.closePath(),t.isPointInPath(e,i)}move(t,e){this.points=this.points.map(i=>({x:i.x+t,y:i.y+e}))}}class h extends l{constructor(t){super(t),this.type="circle",this.x=t.x,this.y=t.y,this.radius=t.radius}render(t){t.save(),t.fillStyle=this.fillStyle,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),t.fill(),t.restore()}getAxes(t){let{x:e,y:i}=this,n=null,l=Number.MAX_SAFE_INTEGER;for(let[s,o]of t.points.entries()){let t=Object(r.a)(e,i,o.x,o.y);t<l&&(l=t,n=o)}let o=new s.default(e,i),h=new s.default(n.x,n.y);return[o.subtract(h).normalize()]}getProjection(t){let{x:e,y:i,radius:r}=this,l=new s.default(e,i).dotProduct(t),o=[l-r,l,l+r];return new n.default(Math.min.call(null,...o),Math.max.call(null,...o))}isPointInPath(t,e,i){return t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),t.closePath(),t.isPointInPath(e,i)}move(t,e){this.x=this.x+t,this.y=this.y+e}}},honw:function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return n});var s=i("ysz4");class n{constructor(t,e){this.x=t,this.y=e}getMagnitude(){return Object(s.a)(0,0,this.x,this.y)}add(t){return new n(this.x+t.x,this.y+t.y)}subtract(t){return new n(this.x-t.x,this.y-t.y)}dotProduct(t){return this.x*t.x+this.y*t.y}perpendicular(){return new n(this.y,-this.x)}normalize(){let t=this.getMagnitude();return t?new n(this.x/t,this.y/t):new n(0,0)}}},iSVj:function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return s});class s{constructor(t,e){this.min=t,this.max=e}overlaps(t){return this.max>t.min&&t.max>this.min}}},kZAv:function(t,e,i){"use strict";i.d(e,"d",function(){return s}),i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"c",function(){return l});const s=500,n=500,r=`${i("0Pcb").a.pc?24:16}px sans-serif`,l="https://snayan.github.io/canvas-demo/"},xMqE:function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return a});var s=i("Qb4n"),n=i("ysz4"),r=i("kZAv"),l=i("0Pcb"),o=i("Vz5x"),h=i("JS/M");class a extends s.a{constructor(){super(),this.polygons=[],this.circles=[],this.ctx=this.getContext("2d"),this.isCollide=!1,this.collideColor="rgba(244, 85, 65, 0.8)",this.collide=new h.default}createPolygon(){let{width:t,height:e,polygons:i}=this,s=["rgba(66, 134, 244, 0.5)","rgba(65, 244, 223, 0.5)"],r=i=>{let r=Math.min(Math.min(t,e)/10,50);r+=r/4*i;let l=Math.floor(Object(n.d)(0,t)),h=Math.floor(Object(n.d)(0,e));return l+r>t&&(l-=r),h+r>e&&(h-=r),new o.Polygon({name:`polygon_${i}`,x:l,y:h,radius:r,edges:5+i,fillStyle:s[i%2],visible:!0})};for(let t=0,e=2;t<e;t++){do{this.draggingSprite=r(t),this.didCollide()}while(this.isCollide);i[t]=this.draggingSprite,this.draggingSprite=null}}createCircle(){let{width:t,height:e,circles:i}=this,s=["rgba(244, 235, 65, 0.5)","rgba(66, 244, 86,0.5)"],r=Math.min(Math.min(t,e)/10,50),l=i=>{let l=Math.floor(Object(n.d)(r,t)),h=Math.floor(Object(n.d)(r,e));return l+r>t&&(l-=r),h+r>e&&(h-=r),new o.Circle({name:`circle_${i}`,x:l,y:h,radius:r,fillStyle:s[i%2],visible:!0})};for(let t=0,e=2;t<e;t++){do{this.draggingSprite=l(t),this.didCollide()}while(this.isCollide);i[t]=this.draggingSprite,this.draggingSprite=null}}drawTitle(){let{ctx:t,width:e,height:i,isCollide:s,collideColor:n}=this;t.save(),t.font=r.a,t.textAlign="center",t.fillStyle=s?n:"rgba(66, 134, 244, 0.8)";let l=t.measureText("M").width;t.fillText(s?"碰撞了":"碰撞检测：分离轴法",e/2,l+l/6+10),t.restore()}drawPolygon(){let{ctx:t,polygons:e}=this;e.forEach(e=>e.render(t))}drawCircle(){let{circles:t,ctx:e}=this;t.forEach(t=>t.render(e))}drawCollideTip(){let{ctx:t,isCollide:e,collideColor:i,width:s,height:n}=this;e&&(t.save(),t.strokeStyle=i,t.lineWidth=10,t.strokeRect(0,0,s,n),t.restore())}bindEvent(){let{width:t,height:e,el:i}=this,s=t=>e=>t.call(this,(t=>{let e,i;return t.preventDefault(),l.a.pc?(e=t.x,i=t.y):(e=t.touches[0].pageX,i=t.touches[0].pageY),{ex:e,ey:i}})(e));l.a.pc?(i.addEventListener("mousedown",s(this.mouseDown),!1),i.addEventListener("mousemove",s(this.mouseMove),!1),i.addEventListener("mouseup",this.mouseUp.bind(this),!1),i.addEventListener("mouseleave",this.mouseUp.bind(this),!1)):(i.addEventListener("touchstart",s(this.mouseDown),!1),i.addEventListener("touchmove",s(this.mouseMove),!1),i.addEventListener("touchend",this.mouseUp.bind(this),!1),i.addEventListener("touchcancel",this.mouseUp.bind(this),!1))}mouseDown({ex:t,ey:e}){let{el:i,ctx:s,polygons:r,circles:l}=this,{x:o,y:h}=Object(n.h)(i,t,e);for(let t of r)if(t.visible&&t.isPointInPath(s,o,h)){this.draggingSprite=t,this.lastMovePoint={x:o,y:h};break}if(!this.draggingSprite)for(let t of l)if(t.visible&&t.isPointInPath(s,o,h)){this.draggingSprite=t,this.lastMovePoint={x:o,y:h};break}}mouseMove({ex:t,ey:e}){let{el:i,ctx:s,collide:r,polygons:l,draggingSprite:o,width:h,height:a,lastMovePoint:d}=this,{x:c,y:u}=Object(n.h)(i,t,e);o&&(this.moveSprite(o,c,u),this.lastMovePoint={x:c,y:u},this.didCollide(),this.draw())}mouseUp(){this.draggingSprite=null,this.lastMovePoint=null}moveSprite(t,e,i){let{width:s,height:n,lastMovePoint:r}=this,l=e-r.x,o=i-r.y;t.move(l,o)}didCollide(){let{polygons:t,circles:e,draggingSprite:i,collide:s}=this;this.isCollide=!1;let n=[...t,...e];if(i)for(let t of n)s.isCandidateForCollide(i,t)&&s.didCollide(i,t)&&(this.isCollide=!0,console.log(`occur collide: ${i.name} and ${t.name}`))}draw(){let{ctx:t,width:e,height:i}=this;t.clearRect(0,0,e,i),this.drawTitle(),this.drawPolygon(),this.drawCircle(),this.drawCollideTip()}render(t){super.render(t),this.createPolygon(),this.createCircle(),this.draw(),this.bindEvent()}}}}]);