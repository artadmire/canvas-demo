(window.webpackJsonp=window.webpackJsonp||[]).push([[13,14,39,40,41,42],{"0Pcb":function(e,t,i){"use strict";const s=function(){const e=window.navigator.userAgent;return window.location.href,function(e){const t={},i=e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0||e.indexOf("iPod")>=0,s=e.indexOf("Android")>0;return t.ios=i,t.android=s,t.mobile=i||s,t.pc=!i&&!s,t}(e)}();t.a=s},"14PU":function(e,t,i){var s=i("8VZJ");"string"==typeof s&&(s=[[e.i,s,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i("aET+")(s,n);s.locals&&(e.exports=s.locals)},"8VZJ":function(e,t,i){(t=e.exports=i("I1BE")(!1)).push([e.i,'.ZKHB3b7wcSwR8Wl6fTxfr{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:stretch;align-items:stretch;height:100%;overflow:hidden;opacity:0;transition:all .5s ease-out;will-change:opacity}._2p3_lfNbTv7jvNTjDcwiNG{margin:20px 10px;padding:0;display:block;float:left;width:calc(25vw - 20px);height:calc(25vw - 20px);display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._3PLz2jKWg5aqWZ0L2XSk1A{width:calc(100vw - 20px);height:calc(100vw - 20px)}._2Aqnhl0UilhQmcJ__tvzcs{-ms-flex:1 1 auto;flex:1 1 auto;width:50%;margin:20px;padding:20px;overflow:hidden;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;border:1px solid #4169e1;border-radius:10px}._3PcgzXzpkVz38FWGWVlBgF{-ms-flex:0 0 auto;flex:0 0 auto;height:42px;display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;overflow:auto}._1J5n2jI7d_iyhVCFsz6kGo{padding:0 10px;background:hsla(0,0%,40%,.6);color:hsla(0,0%,100%,.6);line-height:42px;border-right:1px solid #fff;cursor:pointer}._1J5n2jI7d_iyhVCFsz6kGo:hover{background:hsla(0,0%,40%,.4);color:#fff}.lG27D-ztuflQnRQrYzrEk{background:#f5f2f0;color:#3a73d1;padding:0 10px;line-height:42px;border-right:1px solid #fff;cursor:pointer}.lG27D-ztuflQnRQrYzrEk:hover{color:#0858db}._1Uc2dRqvsUOU-zqNfc0zoP{display:-ms-flexbox;display:flex;-ms-flex:1 1 auto;flex:1 1 auto;overflow:scroll;background:#f5f2f0}.uhY8gttG11j6aitIqgmsp{display:none}._1tG49ZjfMiBGC9SRfhiVb{display:block}._11qLAYl8YioCWH0Wa6nugG{-ms-flex:1 1 auto;flex:1 1 auto;margin:20px;padding:20px;width:50%;border:1px solid #4169e1;border-radius:10px;box-sizing:content-box}._3ddyhRKJ33suqfgO4btVi_{border:none;margin:0;padding:0;border-radius:0;display:block}._2p3_lfNbTv7jvNTjDcwiNG ._11qLAYl8YioCWH0Wa6nugG{margin:0;padding:10px;width:100%;height:100%;box-sizing:border-box;border:1px solid #4169e1;border-radius:10px}._3I7L3oK-Gj0uKsP2dcD9jc{position:fixed;top:calc(50% - 16px);left:calc(50% - 16px);width:32px;height:32px;border-radius:50%;background:#b3d4fc;animation:_2UXogTuqtyG9ZgCq7AZ_5F 1.8s ease infinite}._3I7L3oK-Gj0uKsP2dcD9jc:after,._3I7L3oK-Gj0uKsP2dcD9jc:before{content:"";display:block;position:absolute;height:inherit;width:inherit;background:inherit;border-radius:inherit;animation:_2UXogTuqtyG9ZgCq7AZ_5F 1.8s ease infinite}._3I7L3oK-Gj0uKsP2dcD9jc:before{left:calc(50% - 80px);background:#07a}._3I7L3oK-Gj0uKsP2dcD9jc:after{left:calc(50% + 48px);background:#690}.y1HRpH4VDRhNdBAt12eEI>._2Aqnhl0UilhQmcJ__tvzcs{display:none}._1gBDP-PRzphfndCrFoPJoO{opacity:1}.NMrsesPPXb57BISDZo4Q5{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._3925vOYf0GdFYymPirm6yB{color:red;font-weight:700;font-size:24px}._1PFQRcWzh5gn96QgIv6w9-{color:#999;font-size:12px}@keyframes _2UXogTuqtyG9ZgCq7AZ_5F{0%{top:calc(50% - 16px);transform:rotate(0deg)}50%{top:calc(50% - 80px);transform:rotate(-180deg)}to{top:calc(50% - 16px);transform:rotate(-1turn)}}',""]),t.locals={single:"ZKHB3b7wcSwR8Wl6fTxfr",collect:"_2p3_lfNbTv7jvNTjDcwiNG",collectMobile:"_3PLz2jKWg5aqWZ0L2XSk1A",codes:"_2Aqnhl0UilhQmcJ__tvzcs",codesTab:"_3PcgzXzpkVz38FWGWVlBgF",otherTab:"_1J5n2jI7d_iyhVCFsz6kGo",activeTab:"lG27D-ztuflQnRQrYzrEk",codesSection:"_1Uc2dRqvsUOU-zqNfc0zoP",otherSection:"uhY8gttG11j6aitIqgmsp",activeSection:"_1tG49ZjfMiBGC9SRfhiVb",result:"_11qLAYl8YioCWH0Wa6nugG",mobileResult:"_3ddyhRKJ33suqfgO4btVi_",loading:"_3I7L3oK-Gj0uKsP2dcD9jc",spin:"_2UXogTuqtyG9ZgCq7AZ_5F",mobile:"y1HRpH4VDRhNdBAt12eEI",loaded:"_1gBDP-PRzphfndCrFoPJoO",error:"NMrsesPPXb57BISDZo4Q5",errorTitle:"_3925vOYf0GdFYymPirm6yB",errorTip:"_1PFQRcWzh5gn96QgIv6w9-"}},"8xBV":function(e,t,i){"use strict";var s=i("J66h"),n=i("ysz4"),l=i("kZAv"),o=i("ai4s");var r=class{constructor(e){this.moduleName=e,this.sourcePath=`example/${e}/canvas`,this.requestPath="https://api.github.com/repos/snayan/canvas-demo/contents"}fetch(e){return fetch(`${this.requestPath}/${e}`,{credentials:"omit",method:"get",mode:"cors"})}async getCanvasFiles(){let e,t=[],i=o.a.get(this.moduleName);if(i&&i.length)return i;let s=await this.fetch(this.sourcePath);if(!s.ok)throw new Error(JSON.stringify({status:s.status,statusText:s.statusText,body:await s.text(),url:s.url}));e=await s.json();for(let i of e)"file"===i.type&&(s=await this.fetch(i.path)).ok&&t.push(await s.json());return o.a.set(this.moduleName,t),t}},a=i("0Pcb"),d=i("wZee"),c=i.n(d),h=i("14PU"),u=i.n(h);t.a=class{constructor(e){this.canvasInstances=[],this.moduleName=e,this.el=document.createElement("div"),this.isSingleModule=Object(n.c)(e),this.github=new r(e),this.link=`${l.c}?module=${e}`,a.a.mobile&&this.el.classList.add(u.a.mobile)}loading(){let e=document.createElement("i");return e.classList.add(u.a.loading),document.body.appendChild(e),()=>{document.body.removeChild(e)}}renderCanvas(){let e=this.canvasInstances.length,t=document.createElement("div");t.classList.add(u.a.result),a.a.mobile&&t.classList.add(u.a.mobileResult),this.el.appendChild(t),e>0&&setTimeout(()=>{let{width:i,height:s}=t.getBoundingClientRect(),n=i>2*s,l=document.createElement("div");l.style.display="inline-block",n?(l.style.width=`${100/e}%`,l.style.height="100%"):(l.style.width="100%",l.style.height=`${100/e}%`);for(let e of this.canvasInstances){let i=l.cloneNode();t.appendChild(i),e.render(i)}},0)}async renderCode(){let e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("nav"),n=[],l=[],o="0";try{let e=await this.github.getCanvasFiles();for(let[t,{name:i,content:o}]of e.entries())n.push(`<span class='${0===t?u.a.activeTab:u.a.otherTab}' data-index='${t}'>${i}</span>`),l.push(`<div class='${0===t?u.a.activeSection:u.a.otherSection}' data-index='${t}' ><pre class="language-typescript">${c.a.highlight(s.Base64.decode(o),c.a.languages.javascript,"typescript")}</pre></div>`)}catch(e){let t=JSON.parse(e.message);l.push(`<div class='${u.a.error}'><h4 class='${u.a.errorTitle}'>[${t.status}]${t.statusText}</h4><p class='${u.a.errorTip}'>${t.url}</p></div>`)}i.addEventListener("click",e=>{let s=e.target.dataset.index;if(s===o)return!1;let n=i.querySelectorAll("span"),l=t.querySelector(`div[data-index='${o}']`),r=t.querySelector(`div[data-index='${s}']`);for(let e of n)e.className=e.dataset.index===s?u.a.activeTab:u.a.otherTab;return l.className=u.a.otherSection,r.className=u.a.activeSection,o=s,!1}),i.className=u.a.codesTab,i.innerHTML=n.join(""),e.appendChild(i),t.className=u.a.codesSection,t.innerHTML=l.join(""),e.appendChild(t),e.className=u.a.codes,this.el.appendChild(e)}async render(){let e=this.loading();if(this.el.innerHTML="",document.body.appendChild(this.el),this.isSingleModule)this.el.classList.add(u.a.single),a.a.pc&&await this.renderCode();else{this.el.classList.add(u.a.collect);let e=document.createElement("a");e.innerText=this.moduleName,e.href=this.link,e.style.marginTop="10px",this.el.appendChild(e)}return a.a.mobile&&!this.isSingleModule&&this.el.classList.add(u.a.collectMobile),this.renderCanvas(),e(),setTimeout(()=>{this.el.classList.add(u.a.loaded)},0),this}}},F2gT:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return r});var s=i("8xBV"),n=i("ysz4"),l=i("xMqE");const o="collide_03";class r extends s.a{constructor(){super(o),this.canvasInstances.push(new l.default)}}Object(n.c)(o)&&(new r).render()},"JS/M":function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return n});var s=i("ysz4");class n{constructor(){return this instanceof n?this:new n}isCandidateForCollide(e,t){return e.visible&&t.visible&&e!==t}didCollide(e,t){if("circle"===e.type&&"circle"===t.type){let i=e.x,n=e.y,l=e.radius,o=t.x,r=t.y,a=t.radius;return Object(s.a)(i,n,o,r)<=l+a}let i="circle"===e.type?e.getAxes(t):e.getAxes(),n="circle"===t.type?t.getAxes(e):t.getAxes(),l=[...i,...n];for(let i of l){let s=e.getProjection(i),n=t.getProjection(i);if(!s.overlaps(n))return!1}return!0}}},Qb4n:function(e,t,i){"use strict";var s=i("kZAv");t.a=class{constructor(){this.el=document.createElement("canvas")}initCanvasSize(e,t){this.el.width=e,this.el.height=t,this.width=e,this.height=t}getContext(e,t){return this.el.getContext(e,t)}render(e){this.container=e;let{width:t,height:i}=e.getBoundingClientRect();this.initCanvasSize(t||s.d,i||s.b),this.container.innerHTML="",this.container.appendChild(this.el)}}},Vz5x:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return o}),i.d(t,"Polygon",function(){return r}),i.d(t,"Circle",function(){return a});var s=i("honw"),n=i("iSVj"),l=i("ysz4");class o{constructor({type:e,fillStyle:t,name:i="anonymous",visible:s=!1}={}){this.type=e,this.name=i,this.visible=s,this.fillStyle=t}}class r extends o{constructor(e){super(e),this.type="rect",this.edges=e.edges,this.radius=e.radius,this.x=e.x,this.y=e.y,this.createPoint()}createPoint(){let{x:e,y:t,edges:i,radius:s}=this,n=2*Math.PI/i,l=[];for(let o=0;o<i;o++){let i=n*(o+1);l.push({x:Math.cos(i)*s+e,y:Math.sin(i)*s+t})}this.points=l}render(e){let{edges:t,points:i,fillStyle:s}=this;e.save(),e.fillStyle=s;let n=i[0];e.beginPath(),e.moveTo(n.x,n.y);for(let s=1;s<t;s++)e.lineTo(i[s].x,i[s].y);e.closePath(),e.fill(),e.restore()}getAxes(){let e=this.points,t=[];for(let i=0,n=e.length-1;i<n;i++){let n=new s.default(e[i].x,e[i].y),l=new s.default(e[i+1].x,e[i+1].y);t.push(n.subtract(l).perpendicular().normalize())}let i=e[0],n=e[e.length-1],l=new s.default(n.x,n.y),o=new s.default(i.x,i.y);return t.push(l.subtract(o).perpendicular().normalize()),t}getProjection(e){let t=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(let n of this.points){let l=new s.default(n.x,n.y).dotProduct(e);t=Math.min(t,l),i=Math.max(i,l)}return new n.default(t,i)}isPointInPath(e,t,i){let{edges:s,points:n}=this,l=n[0];e.beginPath(),e.moveTo(l.x,l.y);for(let t=1;t<s;t++)e.lineTo(n[t].x,n[t].y);return e.closePath(),e.isPointInPath(t,i)}move(e,t){this.points=this.points.map(i=>({x:i.x+e,y:i.y+t}))}}class a extends o{constructor(e){super(e),this.type="circle",this.x=e.x,this.y=e.y,this.radius=e.radius}render(e){e.save(),e.fillStyle=this.fillStyle,e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),e.fill(),e.restore()}getAxes(e){let{x:t,y:i}=this,n=null,o=Number.MAX_SAFE_INTEGER;for(let[s,r]of e.points.entries()){let e=Object(l.a)(t,i,r.x,r.y);e<o&&(o=e,n=r)}let r=new s.default(t,i),a=new s.default(n.x,n.y);return[r.subtract(a).normalize()]}getProjection(e){let{x:t,y:i,radius:l}=this,o=new s.default(t,i).dotProduct(e),r=[o-l,o,o+l];return new n.default(Math.min.call(null,...r),Math.max.call(null,...r))}isPointInPath(e,t,i){return e.beginPath(),e.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),e.closePath(),e.isPointInPath(t,i)}move(e,t){this.x=this.x+e,this.y=this.y+t}}},honw:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return n});var s=i("ysz4");class n{constructor(e,t){this.x=e,this.y=t}getMagnitude(){return Object(s.a)(0,0,this.x,this.y)}add(e){return new n(this.x+e.x,this.y+e.y)}subtract(e){return new n(this.x-e.x,this.y-e.y)}dotProduct(e){return this.x*e.x+this.y*e.y}perpendicular(){return new n(this.y,-this.x)}normalize(){let e=this.getMagnitude();return e?new n(this.x/e,this.y/e):new n(0,0)}}},iSVj:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return s});class s{constructor(e,t){this.min=e,this.max=t}overlaps(e){return this.max>e.min&&e.max>this.min}}},kZAv:function(e,t,i){"use strict";i.d(t,"d",function(){return s}),i.d(t,"b",function(){return n}),i.d(t,"a",function(){return l}),i.d(t,"c",function(){return o});const s=500,n=500,l=`${i("0Pcb").a.pc?24:16}px sans-serif`,o="https://snayan.github.io/canvas-demo/"},xMqE:function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return d});var s=i("Qb4n"),n=i("ysz4"),l=i("kZAv"),o=i("0Pcb"),r=i("Vz5x"),a=i("JS/M");class d extends s.a{constructor(){super(),this.polygons=[],this.circles=[],this.ctx=this.getContext("2d"),this.isCollide=!1,this.collideColor="rgba(244, 85, 65, 0.8)",this.collide=new a.default}createPolygon(){let{width:e,height:t,polygons:i}=this,s=["rgba(66, 134, 244, 0.5)","rgba(65, 244, 223, 0.5)"],l=i=>{let l=Math.min(Math.min(e,t)/10,50);l+=l/4*i;let o=Math.floor(Object(n.d)(0,e)),a=Math.floor(Object(n.d)(0,t));return o+l>e&&(o-=l),a+l>t&&(a-=l),new r.Polygon({name:`polygon_${i}`,x:o,y:a,radius:l,edges:5+i,fillStyle:s[i%2],visible:!0})};for(let e=0,t=2;e<t;e++){do{this.draggingSprite=l(e),this.didCollide()}while(this.isCollide);i[e]=this.draggingSprite,this.draggingSprite=null}}createCircle(){let{width:e,height:t,circles:i}=this,s=["rgba(244, 235, 65, 0.5)","rgba(66, 244, 86,0.5)"],l=Math.min(Math.min(e,t)/10,50),o=i=>{let o=Math.floor(Object(n.d)(l,e)),a=Math.floor(Object(n.d)(l,t));return o+l>e&&(o-=l),a+l>t&&(a-=l),new r.Circle({name:`circle_${i}`,x:o,y:a,radius:l,fillStyle:s[i%2],visible:!0})};for(let e=0,t=2;e<t;e++){do{this.draggingSprite=o(e),this.didCollide()}while(this.isCollide);i[e]=this.draggingSprite,this.draggingSprite=null}}drawTitle(){let{ctx:e,width:t,height:i,isCollide:s,collideColor:n}=this;e.save(),e.font=l.a,e.textAlign="center",e.fillStyle=s?n:"rgba(66, 134, 244, 0.8)";let o=e.measureText("M").width;e.fillText(s?"碰撞了":"碰撞检测：分离轴法",t/2,o+o/6+10),e.restore()}drawPolygon(){let{ctx:e,polygons:t}=this;t.forEach(t=>t.render(e))}drawCircle(){let{circles:e,ctx:t}=this;e.forEach(e=>e.render(t))}drawCollideTip(){let{ctx:e,isCollide:t,collideColor:i,width:s,height:n}=this;t&&(e.save(),e.strokeStyle=i,e.lineWidth=10,e.strokeRect(0,0,s,n),e.restore())}bindEvent(){let{width:e,height:t,el:i}=this,s=e=>t=>e.call(this,(e=>{let t,i;return e.preventDefault(),o.a.pc?(t=e.x,i=e.y):(t=e.touches[0].pageX,i=e.touches[0].pageY),{ex:t,ey:i}})(t));o.a.pc?(i.addEventListener("mousedown",s(this.mouseDown),!1),i.addEventListener("mousemove",s(this.mouseMove),!1),i.addEventListener("mouseup",this.mouseUp.bind(this),!1),i.addEventListener("mouseleave",this.mouseUp.bind(this),!1)):(i.addEventListener("touchstart",s(this.mouseDown),!1),i.addEventListener("touchmove",s(this.mouseMove),!1),i.addEventListener("touchend",this.mouseUp.bind(this),!1),i.addEventListener("touchcancel",this.mouseUp.bind(this),!1))}mouseDown({ex:e,ey:t}){let{el:i,ctx:s,polygons:l,circles:o}=this,{x:r,y:a}=Object(n.h)(i,e,t);for(let e of l)if(e.visible&&e.isPointInPath(s,r,a)){this.draggingSprite=e,this.lastMovePoint={x:r,y:a};break}if(!this.draggingSprite)for(let e of o)if(e.visible&&e.isPointInPath(s,r,a)){this.draggingSprite=e,this.lastMovePoint={x:r,y:a};break}}mouseMove({ex:e,ey:t}){let{el:i,ctx:s,collide:l,polygons:o,draggingSprite:r,width:a,height:d,lastMovePoint:c}=this,{x:h,y:u}=Object(n.h)(i,e,t);r&&(this.moveSprite(r,h,u),this.lastMovePoint={x:h,y:u},this.didCollide(),this.draw())}mouseUp(){this.draggingSprite=null,this.lastMovePoint=null}moveSprite(e,t,i){let{width:s,height:n,lastMovePoint:l}=this,o=t-l.x,r=i-l.y;e.move(o,r)}didCollide(){let{polygons:e,circles:t,draggingSprite:i,collide:s}=this;this.isCollide=!1;let n=[...e,...t];if(i)for(let e of n)s.isCandidateForCollide(i,e)&&s.didCollide(i,e)&&(this.isCollide=!0,console.log(`occur collide: ${i.name} and ${e.name}`))}draw(){let{ctx:e,width:t,height:i}=this;e.clearRect(0,0,t,i),this.drawTitle(),this.drawPolygon(),this.drawCircle(),this.drawCollideTip()}render(e){super.render(e),this.createPolygon(),this.createCircle(),this.draw(),this.bindEvent()}}}}]);