(window.webpackJsonp=window.webpackJsonp||[]).push([[45,43,44,46,47,90],{"0Pcb":function(t,e,i){"use strict";const s=function(){const t=window.navigator.userAgent;return window.location.href,function(t){const e={},i=t.indexOf("iPhone")>=0||t.indexOf("iPad")>=0||t.indexOf("iPod")>=0,s=t.indexOf("Android")>0;return e.ios=i,e.android=s,e.mobile=i||s,e.pc=!i&&!s,e}(t)}();e.a=s},"4ZCd":function(t,e,i){"use strict";i.r(e);e.default=class{isPaused(){return this.timeSystem.isPaused}getGameTime(){return this.timeSystem.getElapsed()}}},G12C:function(t,e,i){"use strict";var s;i.r(e),i.d(e,"Sprite",function(){return a}),i.d(e,"CircleSprite",function(){return l}),i.d(e,"RectSprite",function(){return r}),i.d(e,"ImageSprite",function(){return h}),function(t){t[t.Circle=0]="Circle",t[t.Rect=1]="Rect",t[t.Image=2]="Image"}(s||(s={}));class a{constructor(t,e,i){this.name=t,this.ctx=e,this.isVisible=i.isVisible||!0,this.type=i.type||s.Rect,this.fillStyle=i.fillStyle||this.ctx.fillStyle,this.lineWidth=i.lineWidth||this.ctx.lineWidth,this.strokeStyle=i.strokeStyle||this.ctx.strokeStyle,this.shadowOffsetX=i.shadowOffsetX||this.ctx.shadowOffsetX,this.shadowOffsetY=i.shadowOffsetY||this.ctx.shadowOffsetY,this.shadowBlur=i.shadowBlur||this.ctx.shadowBlur,this.shadowColor=i.shadowColor||this.ctx.shadowColor,this.horizontalVelocity=i.horizontalVelocity||0,this.verticalVelocity=i.verticalVelocity||0,this.behaviors=i.behaviors||[]}applyStyle(){let{ctx:t,fillStyle:e,lineWidth:i,strokeStyle:s,shadowOffsetX:a,shadowOffsetY:l,shadowBlur:r,shadowColor:h}=this;t.fillStyle=e,t.lineWidth=i,t.strokeStyle=s}addBehavior(t){Array.isArray(t)?this.behaviors.concat(t):this.behaviors.push(t)}update(t,e,i){for(let s of this.behaviors)s.execute(this,t,e,i)}draw(){this.artist&&"function"==typeof this.artist.draw&&this.artist.draw(this)}}class l extends a{constructor(t,e,i={}){super(t,e,{...i,type:s.Circle}),this.x=i.x||0,this.y=i.y||0,this.radius=i.radius||10,this.startAngle=i.startAngle||0,this.endAngle=i.endAngle||2*Math.PI,this.anticlockwise=i.anticlockwise||!1,this.artist=i.artist||{draw:function(t){let{ctx:e,x:i,y:s,radius:a,startAngle:l,endAngle:r,anticlockwise:h}=t;e.save(),t.applyStyle(),e.beginPath(),e.arc(i,s,a,l,r,h),e.fill(),e.stroke(),e.restore()}}}}class r extends a{constructor(t,e,i){super(t,e,{...i,type:s.Rect}),this.left=i.left||0,this.top=i.top||0,this.width=i.width||10,this.height=i.height||10,this.artist=i.artist||{draw:function(t){let{ctx:e,left:i,top:s,width:a,height:l}=t;e.save(),t.applyStyle(),e.beginPath(),e.rect(i,s,a,l),e.fill(),e.stroke(),e.restore()}}}}class h extends a{constructor(t,e,i){super(t,e,{...i,type:s.Image,isVisible:!1}),this.src=i.src,this.left=i.left||0,this.top=i.top||0,this.isLoaded=!1,this.isLoading=!1,this.el=document.createElement("img"),this.loadCallBack=i.loadCallBack,this.artist=i.artist||{draw:function(t){let{ctx:e,el:i,left:s,top:a,width:l,height:r}=t;e.save(),t.applyStyle(),e.drawImage(i,s,a,l,r),e.restore()}},this.loadImage()}loadImage(t){if(this.isLoading||this.isLoaded)return;let e=()=>{this.isVisible=!0,this.isLoaded=!0,this.isLoading=!1,this.width||(this.width=this.el.width),this.height||(this.height=this.el.height),"function"==typeof this.loadCallBack&&this.loadCallBack(this),"function"==typeof t&&t.call(this)};this.isLoading=!0,this.el.addEventListener("load",e),this.el.addEventListener("error",e),this.el.src=this.src}async draw(){if(!this.isLoaded)return this.loadImage(this.draw);super.draw()}}},PAOK:function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return s});class s{constructor(t){this.canvas=t}isCandidateForCollide(t){return t.isVisible&&!this.isBallOutCanvas(t)}isBallOutCanvas(t){let{width:e,height:i}=this.canvas,{x:s,y:a,radius:l}=t;return s+l<0||s-l>e||a-l>i}didCollide(t,e){let i=t.verticalVelocity/t.horizontalVelocity,s=t.y-i*t.x,a=(e.mockTop-s)/i;return a>e.mockLeft&&a<e.mockLeft+e.mockWidth&&t.x>e.mockLeft&&t.x<e.mockLeft+e.mockWidth&&t.y>e.mockTop&&t.y<e.mockTop+e.mockHeight}}},"UU+w":function(t,e,i){"use strict";i.r(e);var s=i("kZAv"),a=i("0Pcb"),l=i("ysz4"),r=i("4ZCd"),h=i("mVJc"),o=i("G12C"),n=i("PAOK");const c=9.8,d=Object(l.b)();e.default=class extends r.default{constructor(t,e){super(),this.lastFrameTime=0,this.lastFpsTime=0,this.ballHistory=[],this.name=t,this.ctx=e,this.fps=0,this.rate=1,this.isDestroyed=!0,this.sprites=[],this.score=0,this.launchAngle=0,this.lastMouseX=0,this.lastMouseY=0,this.isLaunching=!1,this.isBallFlying=!1,this.isHit=!1,this.meterPerPixel=.02666666666666667,this.openDevDoor="1"===d.admin,this.hitMessage="好球",this.hitMessageOpacity=0}calculateFps(t){if(t-this.lastFpsTime>500){let e=t-this.lastFrameTime;this.lastFrameTime&&e&&(this.fps=Math.round(1e3/e)),this.lastFpsTime=t}}calculateAngle(){let{ball:t,lastMouseX:e,lastMouseY:i}=this,s=e-t.x,a=t.y-i,r=Math.ceil(Object(l.f)(Math.atan(a/s)));e<t.x&&(r=180+r),i>t.x&&a<0&&(r=360+r),this.launchAngle=r%360}calculateSpeed(){let{ball:t,lastMouseX:e,lastMouseY:i,meterPerPixel:s}=this;t.horizontalVelocity=1*(e-t.x)/10,t.verticalVelocity=1*(i-t.y)/10}createBucketSprite(){let{ctx:t,sprites:e,openDevDoor:s}=this,a={src:i("ag+s"),loadCallBack:t=>{let{ctx:e,width:i,height:s}=t;t.left=e.canvas.width-i-20,t.top=e.canvas.height-s-40,t.mockLeft=t.left+40,t.mockTop=t.top+10,t.mockWidth=t.width-50,t.mockHeight=t.height-12},artist:{draw:t=>{let{ctx:e,el:i,left:a,top:l,width:r,height:h}=t;e.save(),t.applyStyle(),e.drawImage(i,a,l,r,h),s&&(e.strokeStyle="rgba(0,0,0,0.6)",e.setLineDash([4,2]),e.beginPath(),e.strokeRect(t.mockLeft,t.mockTop,t.mockWidth,t.mockHeight)),e.restore()}}};this.bucket=new o.ImageSprite("bucket",t,a),e.push(this.bucket)}createBallSprite(){let{ctx:t,sprites:e}=this,i=e.filter(t=>"platform"===t.name)[0];if(i){let s=10,a=i.width,l={x:i.left+a/2,y:i.top-s-1,radius:s,fillStyle:"rgba(128, 216, 83, 1)",strokeStyle:"rgba(128, 216, 83, 1)",horizontalVelocity:0,verticalVelocity:0};this.ball=new o.CircleSprite("ball",t,l),this.ball.addBehavior({execute:this.updateBallPosition.bind(this)}),this.ball.addBehavior({execute:this.updateBallSpeed.bind(this)}),this.ball.addBehavior({execute:this.didCollide.bind(this)}),this.launchX=this.ball.x,this.launchY=this.ball.y,e.push(this.ball)}}createScoreSprite(){let{ctx:t,width:e,sprites:i}=this,a={left:e/2,top:30,fillStyle:"rgb(216, 153, 83)",artist:{draw:t=>{let{ctx:e,fillStyle:i,strokeStyle:a,left:l,top:r}=t;e.save(),e.fillStyle=i,e.font=s.a,e.textAlign="center",e.fillText(this.score+"",l,r),e.restore()}}};i.push(new o.RectSprite("score",t,a))}createPlatform(){let{ctx:t,sprites:e}=this,i={width:60,height:10,left:20,top:t.canvas.height-10-40,fillStyle:"rgba(88, 84, 216, 0.5)",strokeStyle:"rgba(88, 84, 216, 0.5)"};e.push(new o.RectSprite("platform",t,i))}createGuidePlatSprite(){let{ctx:t,sprites:e}=this,i={left:20,top:20,width:a.a.pc?250:140,height:a.a.pc?100:50,fillStyle:"rgba(242, 238, 234, 0.3)",strokeStyle:"rgba(114, 64, 142, 0.3)",artist:{draw:t=>{let{ctx:e,fillStyle:i,strokeStyle:a,shadowOffsetX:l,shadowOffsetY:r,shadowBlur:h,shadowColor:o,left:n,top:c,width:d,height:u}=t,{horizontalVelocity:p,verticalVelocity:f}=this.ball;e.save(),e.fillStyle=i,e.strokeStyle=a,e.rect(n,c,d,u),e.fill(),e.stroke(),e.textAlign="center",e.font=s.a,e.fillStyle="rgb(114, 64, 142, 0.5)";let m=e.measureText("M").width,g=m+m/6,y=(u-2*g)/2;y-=y/4,e.fillText(`速度：${Math.sqrt(p*p+f*f).toFixed(2)}m/s`,n+d/2,c+y+g),e.fillText(`角度：${this.launchAngle}度`,n+d/2,c+y+2*g+y/2),e.restore()}}};e.push(new o.RectSprite("guideWire",t,i))}createSprites(){this.createBucketSprite(),this.createPlatform(),this.createBallSprite(),this.createGuidePlatSprite(),this.createScoreSprite()}updateBallPosition(t,e,i){let{isBallFlying:s,meterPerPixel:a,openDevDoor:l,ballHistory:r}=this;if(s){let{horizontalVelocity:s,verticalVelocity:h,x:o,y:n}=t,c=(e-i)/1e3;if(t.x+=c*s/a,t.y+=c*h/a,l){let i=r[r.length-1];(!i||e-i.timestamp>10)&&r.push({x:t.x,y:t.y,timestamp:e})}}}updateBallSpeed(t,e,i){let{isBallFlying:s,meterPerPixel:a}=this;if(s){let{verticalVelocity:s}=t,a=(e-i)/1e3;t.verticalVelocity=c*a+s}}didCollide(){let{collide:t,ball:e,bucket:i,isBallFlying:s,isHit:a}=this;a&&(e.isVisible=!1),!a&&s&&t.isCandidateForCollide(e)&&(console.log("didCollide"),t.didCollide(e,i)&&(console.log("good ball"),this.score+=2,this.isHit=!0,this.hitMessageOpacity=1)),s&&t.isBallOutCanvas(e)&&this.reset()}updateSprites(t){let{lastFrameTime:e,fps:i}=this;for(let s of this.sprites)s.update(t,e,i)}erase(){let{ctx:t,width:e,height:i}=this;t.clearRect(0,0,e,i)}drawFps(){let{fps:t,width:e,height:i,ctx:a}=this,l=`fps:${t}`;a.save(),a.font=s.a,a.fillStyle="rgb(0, 0, 0, 0.5)";let r=a.measureText(l).width;a.fillText(l,e-r-20,30),a.restore()}drawBg(){let{ctx:t,width:e,height:i}=this;t.save(),t.fillStyle="rgba(65, 202, 244, 0.5)",t.fillRect(0,0,e,i),t.restore()}drawSprites(){for(let t of this.sprites)t.isVisible&&t.draw()}drawGuideWireLine(){let{ctx:t,sprites:e,isLaunching:i,lastMouseX:s,lastMouseY:a,ball:r,launchAngle:h}=this,o=Object(l.g)(h);if(r&&i){let e=r.radius;t.save(),t.beginPath(),t.lineWidth=.5,t.strokeStyle="rgb(249, 117, 192)",t.moveTo(r.x+e*Math.cos(o),r.y-e*Math.sin(o)),t.lineTo(s,a),t.stroke(),t.restore()}}drawHitMessage(){let{hitMessage:t,hitMessageOpacity:e,isHit:i,ctx:s,width:l,height:r,fps:h}=this;e&&(s.save(),s.font=`${a.a.pc?48:32}px sans-serif`,s.textAlign="center",s.globalAlpha=e,s.fillStyle="rgb(38, 165, 40)",s.fillText(t,l/2,r/4),s.restore(),e-=1/h,this.hitMessageOpacity=Math.max(0,e))}drawHorizontalLine(){let{bucket:t,ctx:e,width:i}=this;e.save(),e.lineWidth=1,e.strokeStyle="rgba(0,0,0,0.6)",e.setLineDash([4,2]),e.beginPath(),e.moveTo(0,t.mockTop),e.lineTo(i,t.mockTop),e.stroke(),e.restore()}drawBallHistory(){let{ball:t,ballHistory:e,ctx:i}=this;t.radius,t.anticlockwise,i.save(),i.strokeStyle=t.fillStyle,i.beginPath();for(let{x:t,y:s}of e.slice(0,e.length-1))i.lineTo(t,s),i.stroke();i.restore()}draw(){this.drawBg(),this.drawSprites(),this.drawGuideWireLine(),this.drawHitMessage(),this.openDevDoor&&(this.drawFps(),this.drawHorizontalLine(),this.drawBallHistory())}animate(t){this.erase(),this.calculateFps(t),this.updateSprites(t),this.draw(),this.lastFrameTime=t,window.requestAnimationFrame(this.animate.bind(this))}start(){let t=this.ctx.canvas;this.isDestroyed=!1,this.timeSystem=new h.default,this.collide=new n.default(t),this.width=t.width,this.height=t.height,this.createSprites(),window.requestAnimationFrame(this.animate.bind(this))}resetBall(){let{sprites:t,ball:e}=this,i=t.filter(t=>"platform"===t.name)[0];e.x=i.left+i.width/2,e.y=i.top-e.radius-1,e.horizontalVelocity=0,e.verticalVelocity=0}reset(){this.lastFrameTime=0,this.lastFpsTime=0,this.ball.isVisible=!0,this.isDestroyed=!1,this.launchAngle=0,this.lastMouseX=0,this.lastMouseY=0,this.isLaunching=!1,this.isBallFlying=!1,this.isHit=!1,this.timeSystem.reset(),this.resetBall()}pause(){this.timeSystem.paused()}unPause(){this.timeSystem.unPaused()}playSound(){}setTimeRate(t){t=Math.max(0,t),this.rate=t,this.timeSystem.setTransducer(e=>e*t)}calculateInitLaunchData(){this.ball&&(this.calculateAngle(),this.calculateSpeed())}launchBall(){let{ball:t,isLaunching:e,lastFrameTime:i}=this;e&&t&&(this.isBallFlying=!0,this.ballHistory=[],this.isHit=!1,this.timeSystem.reset(),this.timeSystem.start(i))}destroy(){this.isDestroyed=!0,this.ballHistory=[],this.sprites=[],this.score=0,this.launchAngle=0,this.lastMouseX=0,this.lastMouseY=0,this.isLaunching=!1,this.isBallFlying=!1,this.isHit=!1,this.timeSystem=null,this.collide=null,this.ball=null,this.bucket=null}}},"ag+s":function(t,e){t.exports="dist/images/bucket.5d48015fe4e6d9e9343be64264a9177e.png"},kZAv:function(t,e,i){"use strict";i.d(e,"d",function(){return s}),i.d(e,"b",function(){return a}),i.d(e,"a",function(){return l}),i.d(e,"c",function(){return r});const s=500,a=500,l=`${i("0Pcb").a.pc?24:16}px sans-serif`,r="https://snayan.github.io/canvas-demo/"},mVJc:function(t,e,i){"use strict";i.r(e),i.d(e,"StopWatch",function(){return s}),i.d(e,"AnimationTimer",function(){return a});class s{constructor(){this.startTime=0,this.elapsed=0,this.running=!1}start(){this.startTime=Date.now(),this.running=!0,this.elapsed=0}stop(){this.running=!1,this.elapsed=Date.now()-this.startTime}getElapsedTime(){return this.running?Date.now()-this.startTime:this.elapsed}reset(){this.startTime=Date.now(),this.elapsed=0}isRunning(){return this.running}}class a extends s{constructor(t=1e3,e=a.makeLinear()){super(),this.duration=t,this.transducer=e}getElapsedTime(){if(!this.isRunning()||!this.duration)return 0;let t=super.getElapsedTime(),e=t/this.duration;return t*(this.transducer(e)/e)}isExpired(){return this.getElapsedTime()>this.duration}static makeLinear(){return function(t){return t}}static makeEaseIn(t=1){return function(e){return Math.pow(e,2*t)}}static makeEaseOut(t=1){return function(e){return 1-Math.pow(1-e,2*t)}}static makeEaseInOut(){return function(t){return t-Math.sin(2*t*Math.PI)/(2*Math.PI)}}static makeElastic(t=3){return function(e){return(1-Math.cos(e*Math.PI*t))*(1-e)+e}}static makeBounce(t){let e=a.makeElastic(t);return function(t){return(t=e(t))<=1?t:2-t}}}e.default=class{constructor(){this.elapsed=0,this.isPaused=!1,this.isStart=!1,this.transducer=(t=>t),this.transducerStartTime=0}calculateElapsed(t){let{transducerStartTime:e,transducer:i,isPaused:s}=this;if(!this.isPaused){let s=t-e;"function"==typeof i&&(s=i(s)),this.elapsed+=s,this.transducerStartTime=t}}start(t=Date.now()){void 0==t&&(t=Date.now()),this.elapsed=0,this.isStart=!0,this.transducerStartTime=t}reset(){this.elapsed=0,this.isStart=!1,this.transducerStartTime=Date.now()}paused(t=Date.now()){void 0==t&&(t=Date.now()),this.isPaused||(this.calculateElapsed(t),this.isPaused=!0)}unPaused(){this.isPaused&&(this.transducerStartTime=Date.now(),this.isPaused=!1)}getElapsed(t=Date.now()){let{transducerStartTime:e,transducer:i,isPaused:s}=this;if(this.isPaused)return this.elapsed;let a=t-e;return"function"==typeof i&&(a=i(a)),this.elapsed+a}setTransducer(t,e,i=Date.now()){let{transducer:s}=this;this.calculateElapsed(i),this.transducer=t,Number.isFinite(e)&&setTimeout(this.setTransducer.bind(this,s),e)}}}}]);